{{- define "title" }}
  {{- .Params.Title | default (T .Section) | default .Section }} - {{ .Site.Title -}}
{{- end -}}

{{- define "content" -}}
  <div class="page archive">
    <div class="header">
      {{- /* Title */ -}}
      <h1 class="single-title animate__animated animate__pulse animate__faster">
        {{- .Params.Title | default (T .Section) | default .Section | dict "Count" (len .Pages) "Some" | T "allSome" -}}
      </h1>
      {{- if not .Site.Params.section.hideWordCount -}}
        {{- /* Total word count */ -}}
        {{- /* See https://github.com/hugo-fixit/FixIt/issues/124 */ -}}
        {{- $localData := newScratch -}}
        {{- range .Pages -}}
          {{- $localData.Add "totalWordCount" .WordCount -}}
        {{- end -}}
        {{- with ($localData.Get "totalWordCount") -}}
          {{- $humanizedNum := . -}}
          {{- if ge $humanizedNum 1000 -}}
            {{- $humanizedNum = printf "%.2fK" (div $humanizedNum 1000.0) -}}
          {{- end -}}
          <p class="single-subtitle total-word-count" title='{{- T "taxonomy.totalwordCount" 1 }}'>
            {{- dict "Class" "fa-regular fa-keyboard fa-fw" | partial "plugin/icon.html" }} {{ T "taxonomy.totalwordCount" (dict "Count" $humanizedNum) -}}
          </p>
        {{- end -}}
      {{- end -}}
    </div>

    {{- /* Paginate */ -}}
    {{- if .Pages -}} 

      {{- $enableSummary := .Site.Params.section.summary.enable -}}
      
      {{- if $enableSummary }}
        {{- /* Summary view */ -}}
        {{- $pages := .Pages -}}
        {{- with .Site.Params.section.paginate | default .Site.Params.paginate -}}
          {{- $pages = ($.Paginate $pages .).Pages -}}
        {{- else -}}
          {{- $pages = (.Paginate $pages).Pages -}}
        {{- end -}}
        {{- range $pages -}}
          {{- .Render "summary" -}}
        {{- end -}}
        {{- partial "paginator.html" . -}}
      
      {{- else -}}

        {{- /* Classic view: no summary */ -}}
        {{- $pages := .Pages.GroupByDate "2006" -}}
        {{- with .Site.Params.section.paginate | default .Site.Params.paginate -}}
          {{- $pages = $.Paginate $pages . -}}
        {{- else -}}
          {{- $pages = .Paginate $pages -}}
        {{- end -}}
        {{- partial "recently-updated.html" . -}}
        {{- range $pages.PageGroups -}}
          <h2 class="group-title">{{ .Key }}</h2>
          {{- range .Pages -}}
            <article class="archive-item">
              <a href="{{ .RelPermalink }}" class="archive-item-link">
                {{- cond .Draft "[Draft] " "" -}}
                {{- .Title -}}
              </a>
              <span class="archive-item-date" title='{{ "2006-01-02 15:04:05" | .Date.Format }}'>
                {{- .Date | dateFormat ($.Site.Params.section.dateFormat | default "01-02") -}}
              </span>
            </article>
          {{- end -}}
        {{- end -}}
        {{- partial "paginator.html" . -}}

      {{- end -}}
      
    {{- end -}}

  </div>
{{- end -}}
